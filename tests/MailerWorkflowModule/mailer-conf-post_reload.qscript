#!/usr/bin/env qore

%new-style
%requires QorusClientCore

QorusClient::init();

hash cfg = {
    "workflows/MAILER-WORKFLOW-MODULE/stepinfo/MailerWorkflowModule_SendMail": {
        "smtp_connection_name": "smtp-local-test",
        "email_to": "to@to.to",
        "email_from": "from@from.from",
        "email_subject": "test subject",
        "email_body":  "test body $local:test_var",
    },
};

foreach hash cfg_iterator in (cfg.pairIterator()) {
    foreach hash cfg_item in (cfg_iterator.value.pairIterator()) {
        qrest.put(NOTHING, sprintf("%s/config/%s?action=yaml", cfg_iterator.key, cfg_item.key), {"value": cfg_item.value});
    }
}

